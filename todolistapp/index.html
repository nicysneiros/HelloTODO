<html>

<head>

  <link rel="stylesheet" href="bower_components/angular-material/angular-material.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700,400italic">
  <link rel="stylesheet" href="css/app.css">
  <meta name="viewport" content="initial-scale=1" />

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!--<script data-require="angular.js@*" data-semver="2.0.0-alpha.31" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.3/angular.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-animate.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-aria.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.4/angular-material.min.js"></script>
  -->
  <script src="bower_components/angular/angular.js"></script>
  <script src="bower_components/angular-animate/angular-animate.min.js"></script>
  <script src="bower_components/angular-aria/angular-aria.min.js"></script>
  <script src="bower_components/angular-material/angular-material.min.js"></script>

  <script src="js/app.js"></script>
  <script src="js/controllers.js"></script>
  <script src="js/services.js"></script>

</head>

<body ng-app="todolist">
  <div ng-controller="TODOListCtrl">

    <div class="header"></div>

    <div class="container-add-button">
      <md-button class="md-fab md-primary md-button md-ink-ripple add-button" aria-label="Add TODOList" ng-click="addTODOList()">+</md-button>
    </div>

    <md-content class="md-padding">

      <md-card ng-repeat="todo in todolists">
        <md-card-content>
          <div layout="row">
            <div flex="90" ng-hide="todo.noTitle" ng-click="todo.noTitle = true">
              <h2 class="md-title">{{todo.title}}</h2></div>
            <div flex="90" ng-show="todo.noTitle">
              <md-input-container flex>
                <label>TODO List Title</label>
                <input ng-model="todo.title" autofocus ng-blur="saveTODOList(todo)">
              </md-input-container>
            </div>
            <div flex="10">
              <md-button class="grey" ng-click="deleteTODOList(todo)">X</md-button>
            </div>
          </div>


          <div ng-repeat="task in todo.tasks">
            <div ng-hide="task.editting" ng-mouseenter="task.showButtons = true" ng-mouseleave="task.showButtons=false">
              <md-checkbox md-no-ink ng-model="task.done" ng-change="checkTask(task)">
                {{task.description}}
              </md-checkbox>
            
              <div layout="row" class="task-line-height" ng-show="task.showButtons" >  
                <div flex="50" class="align-center">
                  <span class="deadline"><i>deadline: {{task.deadline | date: 'dd/MM/yyyy'}}</i></span>
                </div>
                <div flex="30" class="align-center">
                  <span class="deadline"><i>{{task.comments.length}} comments</i></span>
                </div>
                <div flex="10">
                  <md-button class="blue small task-button-height" ng-click="task.editting = true">Edit</md-button>
                </div>
                <div flex="10">
                  <md-button class="grey small task-button-height" ng-click="deleteTask(todo, task)">X</md-button>
                </div>
              </div>
            
            </div>

            <div ng-show="task.editting">
              <fieldset class="standard">
                <legend>New Task</legend>
                <md-input-container flex>
                  <label>Task Description</label>
                  <input autofocus ng-model="task.description">
                </md-input-container>
                <div layout="row">
                  <div flex="60">
                    <md-datepicker ng-model="task.deadline"></md-datepicker>
                  </div>
                  <div class="right" flex="20">
                    <md-button class="md-raised" ng-click="task.editting = false">Cancel</md-button>
                  </div>
                  <div class="right" flex="20">
                    <md-button class="md-raised orange" ng-click="addTask(todo, task)">Save</md-button>
                  </div>
                </div>
              </fieldset>
            </div>
          </div>

          <div ng-hide="todo.newTask.add" ng-click="todo.newTask.add = true">
            <i class="grey">Add new task</i>
          </div>

          <div ng-show="todo.newTask.add">
            <fieldset class="standard">
              <legend>New Task</legend>
              <md-input-container flex>
                <label>Task Description</label>
                <input autofocus ng-model="todo.newTask.description">
              </md-input-container>
              <div layout="row">
                <div flex="60">
                  <md-datepicker ng-model="todo.newTask.deadline" md-placeholder="Deadline"></md-datepicker>
                </div>
                <div class="right" flex="20">
                  <md-button class="md-raised" ng-click="todo.newTask.add = false">Cancel</md-button>
                </div>
                <div class="right" flex="20">
                  <md-button class="md-raised orange" ng-click="addTask(todo, todo.newTask)">Add</md-button>
                </div>
              </div>
            </fieldset>
          </div>


        </md-card-content>
      </md-card>

    </md-content>
  </div>
</body>

</html>